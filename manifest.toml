packaging_format = 2

id = "restic"
name = "Restic"
description.en = "Backup program that is fast, efficient and secure"
description.fr = "Programme de sauvegarde rapide, efficace et sécurisé"

version = "0.16.4~ynh1"

maintainers = ["Lionel Coupouchetty-Ramouchetty"]

[upstream]
license = "BSD-2-Clause"
website = "https://restic.net"
admindoc = "https://restic.readthedocs.io/en/latest/"
code = "https://github.com/restic/restic"

[integration]
yunohost = ">= 11.2"
architectures = "all"
multi_instance = true

ldap = false

sso = false

disk = "50M"
ram.build = "50M"
ram.runtime = "50M"

[install]
    [install.server]
    ask.en = "Indicate the server where you want put your backups"
    ask.fr = "Indiquez le serveur où vous voulez faire vos sauvegardes"
    help.en = "IP address or resolvable hostname of your destination server"
    help.fr = "Adresse IP ou nom résolvable de votre serveur de destination"
    type = "string"
    example = "example.com"

    [install.port]
    ask.en = "sftp port of your server"
    ask.fr = "Le port sFTP de votre serveur"
    help.en = "Listening port of your sftp or SSH server. The default value is 22"
    help.fr = "Le port d'écoute de votre serveur sftp ou SSH. La valeur par défaut est 22"
    type = "string"
    example = "22"
    default = "22"

    [install.backup_path]
    ask.en = "The directory where you want your backup repositories to be created in"
    ask.fr = "Le répertoire dans lequel les dépôts restic seront créés"
    help.en = "A complete or relative path to an existing directory on the remote server writable by the remote backup user. Defaults to the login directory"
    help.fr = "Un chemin complet ou relatif vers un répertoire existant sur le serveur distant et accessible en écriture au compte utilisé pour la sauvegarde. Répertoire d'accueil par défaut"
    type = "string"
    example = "./backups"
    default = "."

    [install.ssh_user]
    ask.en = "Indicate the SSH user to use to connect on this server"
    ask.fr = "Indiquez l'utilisateur SSH à utiliser pour se connecter au serveur"
    type = "string"
    example = "john"

    [install.passphrase]
    ask.en = "Indicate a strong passphrase, that you will keep preciously if you want to be able to use your backups"
    ask.fr = "Indiquez une phrase de passe forte que vous garderez précieusement si vous voulez être en mesure d'utiliser vos sauvegardes"
    type = "password"

    [install.conf]
    ask.en = "Would you like to backup your YunoHost configuration?"
    ask.fr = "Souhaitez-vous effectuer des sauvegardes des configurations du système YunoHost ?"
    type = "boolean"
    default = true

    [install.data]
    ask.en = "Would you like to backup mails and user home directory?"
    ask.fr = "Souhaitez-vous effectuer des sauvegardes des mails et des répertoire des utilisateurs ?"
    type = "boolean"
    default = true

    [install.apps]
    ask.en = "Which apps would you backup (list separated by comma or 'all')?"
    ask.fr = "Souhaitez-vous effectuer des sauvegardes de vos applications ?"
    type = "string"
    default = "all"

    [install.allow_extra_space_use]
    ask.en = "Allow backup method to temporarily use more space?"
    ask.fr = "Permettre à la sauvegarde de consommer temporairement de l'espace supplémentaire?"
    help.en = "Some applications as Gitlab can't be backed up with the standard method and require extra space temporarily"
    help.fr = "Certaines applications comme Gitlab ne peuvent être sauvegardées avec la méthode standard et nécessitent d'utiliser plus d'espace disque temporairement"
    type = "boolean"
    default = true

    [install.on_calendar]
    ask.en = "Indicate the backup frequency (see systemd OnCalendar format)"
    ask.fr = "Indiquez la fréquence de la sauvegarde (voir le format OnCalendar de systemd)"
    type = "string"
    example = "Daily"
    default = "*-*-* 0:15:00"

    [install.check_on_calendar]
    ask.en = "Indicate the backup check frequency (see systemd OnCalendar format)"
    ask.fr = "Indiquez la fréquence de vérification de la sauvegarde (voir le format OnCalendar de systemd)"
    type = "string"
    example = "Tue *-*-* 00:15:00"
    default = "Sat *-*-8..31 3:15:00"

    [install.check_read_data_on_calendar]
    ask.en = "Indicate the complete backup check frequency (see systemd OnCalendar format)"
    ask.fr = "Indiquez la fréquence de vérification complète de la sauvegarde (voir le format OnCalendar de systemd)"
    type = "string"
    example = "Tue *-*-* 00:15:00"
    default = "Sat *-*-1..7 3:15:00"

[resources]

    [resources.sources]

        [resources.sources.main]

        url = "https://github.com/restic/restic/releases/download/v0.16.4/restic_0.16.4_linux_amd64.bz2"
        sha256 = "3d4d43c169a9e28ea76303b1e8b810f0dcede7478555fdaa8959971ad499e324"
        rename = "restic"
        autoupdate.strategy = "latest_github_tag"

    [resources.system_user]

    [resources.install_dir]
    dir = "/opt/yunohost/__APP__"

    [resources.ports]

    [resources.permissions]
